{# Parcial: listar_sucursales (sin extends) #}
<div class="container-fluid px-3 px-md-4">
    <!-- Header Responsivo -->
    <div class="row align-items-center mb-4">
        <div class="col-12 col-md-8 mb-3 mb-md-0">
            <h1 class="h3 mb-0 text-gray-800 d-flex align-items-center">
                <i class="fas fa-map-marker-alt me-2" style="color: var(--pozoleria-orange);"></i>
                <span class="d-none d-sm-inline">Gesti√≥n de Sucursales</span>
                <span class="d-sm-none">Sucursales</span>
            </h1>
            <p class="text-muted mb-0 small">Administra las ubicaciones de tu negocio</p>
        </div>
        <div class="col-12 col-md-4">
            {% if session.admin_nombre %}
            <div class="d-flex align-items-center justify-content-between">
                <span class="badge bg-primary px-3 py-2 d-none d-md-inline" style="font-size: 0.9rem;">
                    <i class="fas fa-user-circle me-1"></i>
                    {{ session.admin_nombre }}
                </span>
                <!-- Bot√≥n nueva sucursal m√≥vil -->
                <a href="{{ url_for('admin.nueva_sucursal') }}" class="btn btn-success btn-sm w-100 w-md-auto">
                    <i class="fas fa-plus me-1"></i>
                    <span class="d-none d-sm-inline">Nueva Sucursal</span>
                    <span class="d-sm-none">Nueva</span>
                </a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Mensajes Flash -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} alert-dismissible fade show" role="alert">
                    <i class="fas fa-{{ 'check-circle' if category == 'success' else 'exclamation-triangle' }} me-2"></i>
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- Estad√≠sticas Responsivas -->
    <div class="row g-3 mb-4">
        <div class="col-6 col-lg-3">
            <div class="card border-left-success shadow h-100 py-2 stats-card">
                <div class="card-body p-3">
                    <div class="row no-gutters align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-success text-uppercase mb-1">
                                <span class="d-none d-md-inline">Total Sucursales</span>
                                <span class="d-md-none">Sucursales</span>
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ estadisticas.total_sucursales }}</div>
                        </div>
                        <div class="col-auto d-none d-md-block">
                            <i class="fas fa-store fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-6 col-lg-3">
            <div class="card border-left-info shadow h-100 py-2 stats-card">
                <div class="card-body p-3">
                    <div class="row no-gutters align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-info text-uppercase mb-1">
                                <span class="d-none d-md-inline">Con Productos</span>
                                <span class="d-md-none">Productos</span>
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ estadisticas.sucursales_con_productos }}</div>
                        </div>
                        <div class="col-auto d-none d-md-block">
                            <i class="fas fa-utensils fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-6 col-lg-3">
            <div class="card border-left-warning shadow h-100 py-2 stats-card">
                <div class="card-body p-3">
                    <div class="row no-gutters align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-warning text-uppercase mb-1">
                                <span class="d-none d-md-inline">Pedidos Totales</span>
                                <span class="d-md-none">Pedidos</span>
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">{{ estadisticas.total_pedidos }}</div>
                        </div>
                        <div class="col-auto d-none d-md-block">
                            <i class="fas fa-shopping-cart fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-6 col-lg-3">
            <div class="card border-left-primary shadow h-100 py-2 stats-card">
                <div class="card-body p-3">
                    <div class="row no-gutters align-items-center">
                        <div class="col">
                            <div class="text-xs font-weight-bold text-primary text-uppercase mb-1">
                                Estado
                            </div>
                            <div class="h5 mb-0 font-weight-bold text-gray-800">
                                {% if estadisticas.total_sucursales > 0 %}Activas{% else %}Sin datos{% endif %}
                            </div>
                        </div>
                        <div class="col-auto d-none d-md-block">
                            <i class="fas fa-check-circle fa-2x text-gray-300"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Vista m√≥vil: Cards de sucursales -->
    <div class="d-block d-lg-none mobile-sucursales-container">
        {% if sucursales %}
            <!-- Filtros m√≥vil -->
            <div class="row mb-3">
                <div class="col-6">
                    <select class="form-select form-select-sm" id="filtroEstado" onchange="filtrarPorEstado()">
                        <option value="">Todos los estados</option>
                        <option value="activa">Activas</option>
                        <option value="inactiva">Inactivas</option>
                    </select>
                </div>
                <div class="col-6">
                    <div class="input-group input-group-sm">
                        <input type="text" class="form-control" placeholder="Buscar sucursal..." 
                               id="buscadorSucursal" onkeyup="buscarSucursal()">
                        <span class="input-group-text">
                            <i class="fas fa-search"></i>
                        </span>
                    </div>
                </div>
            </div>

            {% for s in sucursales %}
            <div class="card mb-3 sucursal-card" 
                 data-nombre="{{ s.nombre.lower() }}" 
                 data-estado="{{ 'activa' if s.activa else 'inactiva' }}">
                <div class="card-body p-3">
                    <!-- Header con icono, nombre y estado -->
                    <div class="d-flex align-items-center justify-content-between mb-3">
                        <div class="d-flex align-items-center flex-grow-1">
                            <div class="sucursal-icon-container me-3">
                                <div class="sucursal-icon {% if s.activa %}active{% else %}inactive{% endif %}">
                                    <i class="fas fa-store"></i>
                                </div>
                            </div>
                            <div class="flex-grow-1">
                                <h6 class="sucursal-title mb-1">{{ s.nombre }}</h6>
                                <div class="sucursal-status">
                                    {% if s.activa %}
                                        <span class="badge bg-success">
                                            <i class="fas fa-check-circle me-1"></i>Operativa
                                        </span>
                                    {% else %}
                                        <span class="badge bg-danger">
                                            <i class="fas fa-times-circle me-1"></i>Fuera de servicio
                                        </span>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <!-- Dropdown de acciones -->
                        <div class="dropdown">
                            <button class="btn btn-link btn-sm p-1" type="button" data-bs-toggle="dropdown">
                                <i class="fas fa-ellipsis-v text-muted"></i>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-end">
                                <li>
                                    <a class="dropdown-item" href="{{ url_for('admin.editar_sucursal', id=s.id) }}">
                                        <i class="fas fa-edit me-2 text-primary"></i>Editar
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="{{ url_for('admin.gestionar_horarios', sucursal_id=s.id) }}">
                                        <i class="fas fa-clock me-2 text-info"></i>Gestionar horarios
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#" onclick="verDetallesMobile({{ s.id }}, '{{ s.nombre }}', '{{ s.direccion }}', '{{ s.telefono }}', {{ s.activa|lower }}, {{ s.menuitems|length }}, {{ s.pedidos_clientes|length }})">
                                        <i class="fas fa-eye me-2 text-success"></i>Ver detalles
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="https://maps.google.com/?q={{ s.direccion|urlencode }}" target="_blank">
                                        <i class="fas fa-map-marker-alt me-2 text-warning"></i>Ver en mapa
                                    </a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="tel:{{ s.telefono }}">
                                        <i class="fas fa-phone me-2 text-secondary"></i>Llamar
                                    </a>
                                </li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <a class="dropdown-item text-danger" href="#" 
                                       onclick="confirmarEliminacion({{ s.id }}, '{{ s.nombre }}')">
                                        <i class="fas fa-trash me-2"></i>Eliminar
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- Informaci√≥n de contacto -->
                    <div class="contact-info mb-3">
                        <div class="row g-2">
                            <div class="col-12">
                                <div class="info-item">
                                    <i class="fas fa-map-marker-alt text-danger me-2"></i>
                                    <span class="text-dark small">{{ s.direccion }}</span>
                                </div>
                            </div>
                            <div class="col-12">
                                <div class="info-item">
                                    <i class="fas fa-phone text-success me-2"></i>
                                    <span class="text-dark small">{{ s.telefono }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estad√≠sticas de productos -->
                    <div class="products-stats mb-3">
                        <h6 class="small text-muted mb-2">
                            <i class="fas fa-chart-bar me-1"></i>Estad√≠sticas
                        </h6>
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="stats-badges">
                                {% set productos_disponibles = 0 %}
                                {% for rel in s.menuitems %}
                                    {% if rel.disponible %}
                                        {% set productos_disponibles = productos_disponibles + 1 %}
                                    {% endif %}
                                {% endfor %}
                                
                                <span class="badge bg-success me-1">
                                    <i class="fas fa-check me-1"></i>{{ productos_disponibles }} disponibles
                                </span>
                                <span class="badge bg-info me-1">
                                    <i class="fas fa-utensils me-1"></i>{{ s.menuitems|length }} total
                                </span>
                                <span class="badge bg-warning">
                                    <i class="fas fa-shopping-cart me-1"></i>{{ s.pedidos_clientes|length }} pedidos
                                </span>
                            </div>
                            <!-- Bot√≥n de edici√≥n r√°pida -->
                            <a href="{{ url_for('admin.editar_sucursal', id=s.id) }}" 
                               class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-edit"></i>
                            </a>
                        </div>
                    </div>
                    
                    <!-- Productos disponibles (muestra limitada) -->
                    {% if s.menuitems|length > 0 %}
                    <div class="products-preview">
                        <h6 class="small text-muted mb-2">
                            <i class="fas fa-utensils me-1"></i>Productos ({{ s.menuitems|length }})
                        </h6>
                        <div class="products-badges">
                            {% for rel in s.menuitems[:3] %}
                                {% if rel.disponible %}
                                    <span class="badge bg-success me-1 mb-1">
                                        <i class="fas fa-check me-1"></i>{{ rel.menuitem.nombre }}
                                    </span>
                                {% else %}
                                    <span class="badge bg-danger me-1 mb-1">
                                        <i class="fas fa-times me-1"></i>{{ rel.menuitem.nombre }}
                                    </span>
                                {% endif %}
                            {% endfor %}
                            {% if s.menuitems|length > 3 %}
                                <span class="badge bg-secondary">
                                    +{{ s.menuitems|length - 3 }} m√°s
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    {% else %}
                    <div class="no-products">
                        <div class="alert alert-warning small mb-0" style="border-radius: 8px;">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            <strong>Sin productos asignados</strong>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        {% else %}
            <!-- Estado vac√≠o m√≥vil -->
            <div class="text-center py-5">
                <i class="fas fa-store" style="font-size: 4em; color: var(--pozoleria-orange); opacity: 0.5;"></i>
                <h5 class="mt-3 text-muted">No hay sucursales registradas</h5>
                <p class="text-muted mb-4">Comienza agregando tu primera sucursal</p>
                <a href="{{ url_for('admin.nueva_sucursal') }}" class="btn btn-success btn-lg">
                    <i class="fas fa-plus me-2"></i>Crear Primera Sucursal
                </a>
            </div>
        {% endif %}
    </div>

    <!-- Vista escritorio: Tabla original mejorada -->
    <div class="d-none d-lg-block">
        <div class="card shadow mb-4">
            <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                <h6 class="m-0 font-weight-bold" style="color: var(--pozoleria-orange);">
                    <i class="fas fa-list me-2"></i>Lista de Sucursales
                </h6>
                <div class="d-flex gap-2">
                    <a href="{{ url_for('admin.dashboard') }}" class="btn btn-secondary btn-sm">
                        <i class="fas fa-arrow-left me-1"></i>Panel Principal
                    </a>
                    <a href="{{ url_for('admin.nueva_sucursal') }}" class="btn btn-success btn-sm">
                        <i class="fas fa-plus me-1"></i>Nueva Sucursal
                    </a>
                </div>
            </div>
            <div class="card-body">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                        <thead>
                            <tr>
                                <th width="6%">
                                    <i class="fas fa-hashtag me-1"></i>ID
                                </th>
                                <th width="20%">
                                    <i class="fas fa-store me-1"></i>Sucursal
                                </th>
                                <th width="18%">
                                    <i class="fas fa-map-marker-alt me-1"></i>Direcci√≥n
                                </th>
                                <th width="10%">
                                    <i class="fas fa-phone me-1"></i>Contacto
                                </th>
                                <th width="8%">
                                    <i class="fas fa-toggle-on me-1"></i>Estado
                                </th>
                                <th width="20%">
                                    <i class="fas fa-utensils me-1"></i>Productos Disponibles
                                </th>
                                <th width="10%">
                                    <i class="fas fa-chart-bar me-1"></i>Estad√≠sticas
                                </th>
                                <th width="8%">
                                    <i class="fas fa-cogs me-1"></i>Acciones
                                </th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for s in sucursales %}
                            <tr>
                                <td class="text-center">
                                    <span class="badge bg-secondary px-2 py-1">#{{ s.id }}</span>
                                </td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <div class="avatar-sm {% if s.activa %}bg-gradient-primary{% else %}bg-secondary{% endif %} rounded-circle d-flex align-items-center justify-content-center me-3">
                                            <i class="fas fa-store text-white"></i>
                                        </div>
                                        <div>
                                            <div class="font-weight-bold h6 mb-1">{{ s.nombre }}</div>
                                            <div class="text-muted small">
                                                {% if s.activa %}
                                                    <i class="fas fa-check-circle text-success me-1"></i>Operativa
                                                {% else %}
                                                    <i class="fas fa-times-circle text-danger me-1"></i>Fuera de servicio
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="d-flex align-items-start">
                                        <i class="fas fa-map-marker-alt text-danger me-2 mt-1"></i>
                                        <div>
                                            <div class="font-weight-bold">{{ s.direccion }}</div>
                                            <small class="text-muted">
                                                <i class="fas fa-external-link-alt me-1"></i>
                                                <a href="https://maps.google.com/?q={{ s.direccion|urlencode }}" 
                                                   target="_blank" class="text-decoration-none">Ver en mapa</a>
                                            </small>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        <i class="fas fa-phone text-success me-2"></i>
                                        <div>
                                            <div class="font-weight-bold">{{ s.telefono }}</div>
                                            <small class="text-muted">
                                                <a href="tel:{{ s.telefono }}" class="text-decoration-none">
                                                    <i class="fas fa-phone-alt me-1"></i>Llamar
                                                </a>
                                            </small>
                                        </div>
                                    </div>
                                </td>
                                <td class="text-center">
                                    {% if s.activa %}
                                        <span class="badge bg-success px-3 py-2 d-inline-flex align-items-center">
                                            <i class="fas fa-check-circle me-2"></i>
                                            <span class="fw-bold">ACTIVA</span>
                                        </span>
                                    {% else %}
                                        <span class="badge bg-danger px-3 py-2 d-inline-flex align-items-center">
                                            <i class="fas fa-times-circle me-2"></i>
                                            <span class="fw-bold">INACTIVA</span>
                                        </span>
                                    {% endif %}
                                </td>
                                <td>
                                    <div class="d-flex flex-wrap gap-1">
                                        {% set productos_disponibles = 0 %}
                                        {% set productos_no_disponibles = 0 %}
                                        {% for rel in s.menuitems %}
                                            {% if rel.disponible %}
                                                {% set productos_disponibles = productos_disponibles + 1 %}
                                                <span class="badge bg-success mb-1" title="Producto disponible">
                                                    <i class="fas fa-check me-1"></i>{{ rel.menuitem.nombre }}
                                                </span>
                                            {% else %}
                                                {% set productos_no_disponibles = productos_no_disponibles + 1 %}
                                                <span class="badge bg-danger mb-1" title="Producto no disponible">
                                                    <i class="fas fa-times me-1"></i>{{ rel.menuitem.nombre }}
                                                </span>
                                            {% endif %}
                                        {% endfor %}
                                        {% if s.menuitems|length == 0 %}
                                            <span class="badge bg-secondary">
                                                <i class="fas fa-info-circle me-1"></i>Sin productos asignados
                                            </span>
                                        {% endif %}
                                    </div>
                                </td>
                                <td>
                                    <div class="text-center">
                                        <div class="mb-2">
                                            <span class="badge bg-success" title="Productos disponibles">
                                                <i class="fas fa-check-circle me-1"></i>
                                                {% set disponibles_count = 0 %}
                                                {% for rel in s.menuitems %}
                                                    {% if rel.disponible %}
                                                        {% set disponibles_count = disponibles_count + 1 %}
                                                    {% endif %}
                                                {% endfor %}
                                                {{ disponibles_count }} disponibles
                                            </span>
                                        </div>
                                        <div>
                                            <span class="badge bg-warning" title="Total productos asignados">
                                                <i class="fas fa-shopping-cart me-1"></i>{{ s.pedidos_clientes|length }} pedidos
                                            </span>
                                        </div>
                                        <div class="mt-1">
                                            <span class="badge bg-info" title="Total productos en sucursal">
                                                <i class="fas fa-utensils me-1"></i>{{ s.menuitems|length }} total
                                            </span>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <div class="d-flex gap-1">
                                        <a href="{{ url_for('admin.editar_sucursal', id=s.id) }}" 
                                           class="btn btn-primary btn-sm" title="Editar sucursal">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{{ url_for('admin.gestionar_horarios', sucursal_id=s.id) }}" 
                                           class="btn btn-warning btn-sm" title="Gestionar horarios">
                                            <i class="fas fa-clock"></i>
                                        </a>
                                        <button class="btn btn-info btn-sm" title="Ver detalles" 
                                                onclick="verDetalles({{ s.id }})">
                                            <i class="fas fa-eye"></i>
                                        </button>
                                        <button class="btn btn-danger btn-sm" title="Eliminar sucursal" 
                                                onclick="confirmarEliminacion({{ s.id }}, '{{ s.nombre }}')">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% else %}
                            <tr>
                                <td colspan="8" class="text-center text-muted py-5">
                                    <i class="fas fa-store fa-3x text-muted mb-3"></i>
                                    <div class="h5">No hay sucursales registradas</div>
                                    <p class="text-muted">Comienza agregando tu primera sucursal</p>
                                    <a href="{{ url_for('admin.nueva_sucursal') }}" class="btn btn-success">
                                        <i class="fas fa-plus me-2"></i>Crear Primera Sucursal
                                    </a>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

{# Estilos base movidos a admin_pages.css (listar_sucursales.html secci√≥n 1) #}

<script>
function verDetalles(sucursalId) {
    // Obtener el nombre de la sucursal desde el DOM
    const fila = event.target.closest('tr');
    const nombre = fila.querySelector('.font-weight-bold.h6').textContent;
    
    // Contar productos disponibles y no disponibles
    const productosDisponibles = fila.querySelectorAll('.badge.bg-success').length - 1; // -1 por el badge de estad√≠sticas
    const productosNoDisponibles = fila.querySelectorAll('.badge.bg-danger').length;
    const totalProductos = productosDisponibles + productosNoDisponibles;
    
    // Obtener datos de pedidos desde el badge
    const badgePedidos = fila.querySelector('.badge.bg-warning');
    const pedidos = badgePedidos ? badgePedidos.textContent.match(/\d+/)[0] : '0';
    
    let mensaje = 'DETALLES DE LA SUCURSAL\n\n';
    mensaje += 'üè™ Sucursal: ' + nombre + '\n';
    mensaje += 'üìä INVENTARIO:\n';
    mensaje += '  ‚úÖ Productos disponibles: ' + productosDisponibles + '\n';
    mensaje += '  ‚ùå Productos no disponibles: ' + productosNoDisponibles + '\n';
    mensaje += '  üì¶ Total productos: ' + totalProductos + '\n\n';
    mensaje += 'üìà ACTIVIDAD:\n';
    mensaje += '  üõí Pedidos realizados: ' + pedidos + '\n\n';
    mensaje += '‚öôÔ∏è Acciones disponibles:\n';
    mensaje += '‚Ä¢ Editar informaci√≥n de la sucursal\n';
    mensaje += '‚Ä¢ Gestionar productos disponibles\n';
    mensaje += '‚Ä¢ Ver historial de pedidos\n';
    mensaje += '‚Ä¢ Actualizar datos de contacto';
    
    alert(mensaje);
}

function confirmarEliminacion(id, nombre) {
    // Crear y mostrar modal de confirmaci√≥n personalizado
    const modalHtml = `
        <div class="modal fade" id="modalEliminar" tabindex="-1" aria-labelledby="modalEliminarLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow-lg">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title" id="modalEliminarLabel">
                            <i class="fas fa-exclamation-triangle me-2"></i>Confirmar eliminaci√≥n
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="text-center mb-3">
                            <i class="fas fa-store fa-4x text-danger mb-3"></i>
                            <h5 class="text-dark">¬øEst√°s seguro de eliminar la sucursal?</h5>
                            <p class="text-muted mb-3">
                                <strong>"${nombre}"</strong>
                            </p>
                            <div class="alert alert-warning">
                                <i class="fas fa-warning me-2"></i>
                                <strong>Esta acci√≥n no se puede deshacer.</strong>
                                <br>Se eliminar√° permanentemente la sucursal y toda su informaci√≥n.
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer justify-content-center">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>Cancelar
                        </button>
                        <form method="POST" action="/admin/sucursales/eliminar/${id}" style="display: inline;">
                            <button type="submit" class="btn btn-danger">
                                <i class="fas fa-trash me-2"></i>Eliminar sucursal
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    `;
    
    // Remover modal existente si hay uno
    const modalExistente = document.getElementById('modalEliminar');
    if (modalExistente) {
        modalExistente.remove();
    }
    
    // Agregar modal al body
    document.body.insertAdjacentHTML('beforeend', modalHtml);
    
    // Mostrar modal
    const modal = new bootstrap.Modal(document.getElementById('modalEliminar'));
    modal.show();
    
    // Limpiar modal despu√©s de cerrar
    document.getElementById('modalEliminar').addEventListener('hidden.bs.modal', function () {
        this.remove();
    });
}
</script>
<!-- Estilos CSS personalizados -->
{# Estilos avanzados movidos a admin_pages.css (listar_sucursales.html secci√≥n 2) #}

<!-- JavaScript para funcionalidad interactiva -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Inicializar componentes
    initializeSearch();
    initializeFilters();
    initializeAnimations();
    
    // Agregar efecto fade-in a las tarjetas
    const cards = document.querySelectorAll('.sucursal-card, .stat-card');
    cards.forEach((card, index) => {
        setTimeout(() => {
            card.classList.add('fade-in');
        }, index * 100);
    });
});

// Funcionalidad de b√∫squeda
function initializeSearch() {
    const searchInput = document.getElementById('searchInput');
    if (searchInput) {
        searchInput.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            filterSucursales(searchTerm);
        });
    }
}

// Filtrar sucursales
function filterSucursales(searchTerm) {
    const mobileCards = document.querySelectorAll('.sucursal-card');
    const desktopRows = document.querySelectorAll('#dataTable tbody tr');
    
    // Filtrar tarjetas m√≥viles
    mobileCards.forEach(card => {
        const nombre = card.querySelector('.card-title')?.textContent.toLowerCase() || '';
        const direccion = card.querySelector('.contact-item')?.textContent.toLowerCase() || '';
        
        if (nombre.includes(searchTerm) || direccion.includes(searchTerm)) {
            card.style.display = 'block';
            card.classList.add('fade-in');
        } else {
            card.style.display = 'none';
        }
    });
    
    // Filtrar filas de escritorio
    desktopRows.forEach(row => {
        const cells = row.querySelectorAll('td');
        let matchFound = false;
        
        cells.forEach(cell => {
            if (cell.textContent.toLowerCase().includes(searchTerm)) {
                matchFound = true;
            }
        });
        
        row.style.display = matchFound ? '' : 'none';
    });
}

// Inicializar filtros
function initializeFilters() {
    const statusFilter = document.getElementById('statusFilter');
    if (statusFilter) {
        statusFilter.addEventListener('change', function(e) {
            filterByStatus(e.target.value);
        });
    }
}

// Filtrar por estado
function filterByStatus(status) {
    const mobileCards = document.querySelectorAll('.sucursal-card');
    const desktopRows = document.querySelectorAll('#dataTable tbody tr');
    
    mobileCards.forEach(card => {
        if (status === 'all') {
            card.style.display = 'block';
        } else {
            const cardStatus = card.querySelector('.sucursal-status');
            const isActive = cardStatus?.classList.contains('status-activa');
            
            if ((status === 'activa' && isActive) || (status === 'inactiva' && !isActive)) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        }
    });
    
    desktopRows.forEach(row => {
        if (status === 'all') {
            row.style.display = '';
        } else {
            const statusBadge = row.querySelector('.badge');
            const isActive = statusBadge?.classList.contains('bg-success');
            
            if ((status === 'activa' && isActive) || (status === 'inactiva' && !isActive)) {
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        }
    });
}

// Inicializar animaciones
function initializeAnimations() {
    // Observador de intersecci√≥n para animaciones
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('fade-in');
            }
        });
    }, {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    });
    
    // Observar elementos que necesitan animaci√≥n
    document.querySelectorAll('.sucursal-card, .stat-card').forEach(el => {
        observer.observe(el);
    });
}

// Funciones de acci√≥n
function verDetalles(sucursalId) {
    // Implementar modal de detalles
    console.log('Ver detalles de sucursal:', sucursalId);
    alert('Funcionalidad de detalles en desarrollo');
}

function confirmarEliminacion(sucursalId, nombreSucursal) {
    if (confirm(`¬øEst√°s seguro de que deseas eliminar la sucursal "${nombreSucursal}"?`)) {
        // Implementar eliminaci√≥n
        console.log('Eliminar sucursal:', sucursalId);
        alert('Funcionalidad de eliminaci√≥n en desarrollo');
    }
}

// Funci√≥n para llamar por tel√©fono
function llamarTelefono(telefono) {
    window.open(`tel:${telefono}`, '_self');
}

// Funci√≥n para abrir en mapas
function abrirEnMapa(direccion) {
    const url = `https://maps.google.com/?q=${encodeURIComponent(direccion)}`;
    window.open(url, '_blank');
}

// Actualizar estad√≠sticas en tiempo real
function actualizarEstadisticas() {
    const totalSucursales = document.querySelectorAll('.sucursal-card').length;
    const sucursalesActivas = document.querySelectorAll('.status-activa').length;
    const sucursalesInactivas = totalSucursales - sucursalesActivas;
    
    // Actualizar contadores en las tarjetas de estad√≠sticas
    const statsCards = document.querySelectorAll('.stat-card .stat-number');
    if (statsCards.length >= 3) {
        statsCards[0].textContent = totalSucursales;
        statsCards[1].textContent = sucursalesActivas;
        statsCards[2].textContent = sucursalesInactivas;
    }
}

// Ejecutar al cargar la p√°gina
document.addEventListener('DOMContentLoaded', actualizarEstadisticas);
</script>

