{# Parcial: editar_administrador (sin extends) #}
<div class="container py-4">
    <a href="{{ url_for('admin.listar_administradores') }}" class="btn btn-secondary mb-3">&larr; Volver a administradores</a>
    <h2>Editar Administrador</h2>
    <form method="post">
        <input class="form-control mb-2" type="text" name="usuario" value="{{ admin.usuario }}" required>
        <input class="form-control mb-2" type="password" name="password" value="{{ admin.password }}" required>
        <input class="form-control mb-2" type="text" name="nombre" value="{{ admin.nombre }}" required>
        <div class="mb-3">
            <label class="form-label fw-bold">Rol</label>
            <select class="form-select" name="rol" id="rolSelect" required>
                <option value="empleado" {% if admin.rol != 'super' %}selected{% endif %}>Empleado</option>
                <option value="super" {% if admin.rol == 'super' %}selected{% endif %}>Super</option>
            </select>
        </div>
        <div class="mb-3" id="sucursalesAsignacion">
            <label class="form-label fw-bold">Sucursales asignadas</label>
            <div class="border rounded p-2" style="max-height:240px;overflow:auto;">
                {% for s in sucursales %}
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="suc{{ s.id }}" name="sucursales_ids" value="{{ s.id }}" {% if s.id in sucursales_asignadas %}checked{% endif %}>
                    <label class="form-check-label" for="suc{{ s.id }}">{{ s.nombre }}</label>
                </div>
                {% endfor %}
            </div>
            <small class="text-muted">Solo visible si el rol es Empleado.</small>
        </div>
        <button class="btn btn-success" type="submit">Guardar cambios</button>
    </form>
    <script>
    document.addEventListener('DOMContentLoaded', function(){
        const rol = document.getElementById('rolSelect');
        const asignacion = document.getElementById('sucursalesAsignacion');
        function toggle(){ asignacion.style.display = (rol.value === 'super') ? 'none' : 'block'; }
        rol.addEventListener('change', toggle); toggle();
    });
    </script>
</div>
